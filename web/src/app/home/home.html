<div class="container">

  <h2>TinyTickets ğŸŸï¸</h2>

  <!-- ---------------------------------------
       CREATE TICKET
  ---------------------------------------- -->
  <section class="card">
    <h3>Create Ticket</h3>
    <form (submit)="$event.preventDefault(); create()" class="ticket-form">
      <input placeholder="Title" [(ngModel)]="title" name="title" required />
      <button type="submit">Add</button>
    </form>
  </section>

  <!-- ---------------------------------------
       TICKET LIST
  ---------------------------------------- -->
  <section class="card">
    <h3>Tickets</h3>

    <ul *ngIf="tickets.length > 0; else noTickets">
      <li *ngFor="let t of tickets" class="ticket-item">
        <span>#{{t.id}} â€“ {{t.title}}</span>
        <button (click)="publish(t.id)" class="publish-btn">Publish</button>
      </li>
    </ul>

    <ng-template #noTickets>
      <p class="empty">No tickets created yet.</p>
    </ng-template>
  </section>

  <!-- ---------------------------------------
       FILE UPLOAD
  ---------------------------------------- -->
  <section class="card">
    <h3>Upload Attachment</h3>
    <input type="file" (change)="onFileSelected($event)" />
  </section>

  <!-- ---------------------------------------
       FILE LIST
  ---------------------------------------- -->
  <section class="card">
    <h3>Uploaded Files</h3>

    <div *ngIf="files.length > 0; else noFiles">
      <div *ngFor="let f of files" class="file-card">
        <p><strong>{{ f.fileName }}</strong></p>
        <p class="timestamp">{{ f.uploadedOn | date:'medium' }}</p>

        <!-- Image preview -->
        <img *ngIf="f.contentType.startsWith('image')" 
             [src]="f.url"
             class="preview-img"/>

        <a [href]="f.url" download class="download-link">Download</a>
        <button class="delete-btn" (click)="delete(f.id)">Delete</button>
      </div>
    </div>

    <ng-template #noFiles>
      <p class="empty">No files uploaded yet.</p>
    </ng-template>

    <button class="download-btn" (click)="downloadReport()">
      Download PDF Report
    </button>
  </section>
</div>